!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/upgrade/static")):"function"==typeof define&&define.amd?define("@angular/common/upgrade",["exports","@angular/common","@angular/core","@angular/upgrade/static"],e):e(((t=t||self).ng=t.ng||{},t.ng.common=t.ng.common||{},t.ng.common.upgrade={}),t.ng.common,t.ng.core,t.ng.upgrade.static)}(this,function(t,o,e,r){"use strict";var a=function(){return(a=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var a in e=arguments[r])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};var i=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,n=/^\s*[\\/]{2,}/,h=/^\s*(javascript|mailto):/i,c={"http:":80,"https:":443,"ftp:":21},s=(p.prototype.initialize=function(t){var n=this,s=t.get("$rootScope"),a=t.get("$rootElement");a.on("click",function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey||2===t.which||2===t.button)){for(var e=t.target;e&&"a"!==e.nodeName.toLowerCase();)if(e===a[0]||!(e=e.parentNode))return;if(function(t){return void 0!==t.href}(e)){var r=e.href,o=e.getAttribute("href");h.test(r)||!r||e.getAttribute("target")||t.isDefaultPrevented()||n.$$parseLinkUrl(r,o)&&(t.preventDefault(),n.absUrl()!==n.browserUrl()&&s.$apply())}}}),this.location.onUrlChange(function(t,e){var r=n.absUrl(),o=n.$$state;n.$$parse(t),t=n.absUrl(),n.$$state=e;var a=s.$broadcast("$locationChangeStart",t,r,e,o).defaultPrevented;n.absUrl()===t&&(a?(n.$$parse(r),n.state(o),n.setBrowserUrlWithFallback(r,!1,o)):(n.initalizing=!1,s.$broadcast("$locationChangeSuccess",t,r,e,o),n.resetBrowserUpdate()),s.$$phase||s.$digest())}),s.$watch(function(){if(n.initalizing||n.updateBrowser){n.updateBrowser=!1;var r=n.browserUrl(),t=n.absUrl(),o=n.browserState(),a=n.$$replace,i=!n.urlCodec.areEqual(r,t)||o!==n.$$state;(n.initalizing||i)&&(n.initalizing=!1,s.$evalAsync(function(){var t=n.absUrl(),e=s.$broadcast("$locationChangeStart",t,r,n.$$state,o).defaultPrevented;n.absUrl()===t&&(e?(n.$$parse(r),n.$$state=o):(i&&(n.setBrowserUrlWithFallback(t,a,o===n.$$state?null:n.$$state),n.$$replace=!1),s.$broadcast("$locationChangeSuccess",t,r,n.$$state,o)))}))}n.$$replace=!1})},p.prototype.resetBrowserUpdate=function(){this.$$replace=!1,this.$$state=this.browserState(),this.updateBrowser=!1,this.lastBrowserUrl=this.browserUrl()},p.prototype.browserUrl=function(t,e,r){if(void 0===r&&(r=null),t){var o=this.lastHistoryState===r;return t=this.urlCodec.parse(t).href,this.lastBrowserUrl===t&&o||(this.lastBrowserUrl=t,this.lastHistoryState=r,t=this.stripBaseUrl(this.getServerBase(),t)||t,e?this.locationStrategy.replaceState(r,"",t,""):this.locationStrategy.pushState(r,"",t,""),this.cacheState()),this}return this.platformLocation.href},p.prototype.cacheState=function(){this.cachedState=this.platformLocation.getState(),void 0===this.cachedState&&(this.cachedState=null),function(t,e){if(t===e)return!0;if(!t||!e)return!1;try{return!(t.prototype!==e.prototype||Array.isArray(t)&&Array.isArray(e))&&JSON.stringify(t)===JSON.stringify(e)}catch(t){return!1}}(this.cachedState,this.lastCachedState)&&(this.cachedState=this.lastCachedState),this.lastCachedState=this.cachedState,this.lastHistoryState=this.cachedState},p.prototype.browserState=function(){return this.cachedState},p.prototype.stripBaseUrl=function(t,e){if(e.startsWith(t))return e.substr(t.length)},p.prototype.getServerBase=function(){var t=this.platformLocation,e=t.protocol,r=t.hostname,o=t.port,a=e+"//"+r+(o?":"+o:"")+(this.locationStrategy.getBaseHref()||"/");return a.endsWith("/")?a:a+"/"},p.prototype.parseAppUrl=function(t){if(n.test(t))throw new Error("Bad Path - URL cannot start with double slashes: "+t);var e="/"!==t.charAt(0);e&&(t="/"+t);var r=this.urlCodec.parse(t,this.getServerBase());if("string"==typeof r)throw new Error("Bad URL - Cannot parse URL: "+t);var o=e&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname;this.$$path=this.urlCodec.decodePath(o),this.$$search=this.urlCodec.decodeSearch(r.search),this.$$hash=this.urlCodec.decodeHash(r.hash),this.$$path&&"/"!==this.$$path.charAt(0)&&(this.$$path="/"+this.$$path)},p.prototype.onChange=function(t,e){void 0===e&&(e=function(t){}),this.$$changeListeners.push([t,e])},p.prototype.$$notifyChangeListeners=function(a,i,n,s){void 0===a&&(a=""),void 0===n&&(n=""),this.$$changeListeners.forEach(function(t){var e=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,a,i=r.call(t),n=[];try{for(;(void 0===e||0<e--)&&!(o=i.next()).done;)n.push(o.value)}catch(t){a={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return n}(t,2),r=e[0],o=e[1];try{r(a,i,n,s)}catch(t){o(t)}})},p.prototype.$$parse=function(t){var e;if(void 0===(e=t.startsWith("/")?t:this.stripBaseUrl(this.getServerBase(),t)))throw new Error('Invalid url "'+t+'", missing path prefix "'+this.getServerBase()+'".');this.parseAppUrl(e),this.$$path||(this.$$path="/"),this.composeUrls()},p.prototype.$$parseLinkUrl=function(t,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var r,o=this.stripBaseUrl(this.getServerBase(),t);return void 0!==o?r=this.getServerBase()+o:this.getServerBase()===t+"/"&&(r=this.getServerBase()),r&&this.$$parse(r),!!r},p.prototype.setBrowserUrlWithFallback=function(t,e,r){var o=this.url(),a=this.$$state;try{this.browserUrl(t,e,r),this.$$state=this.browserState(),this.$$notifyChangeListeners(t,r,o,a)}catch(t){throw this.url(o),this.$$state=a,t}},p.prototype.composeUrls=function(){this.$$url=this.urlCodec.normalize(this.$$path,this.$$search,this.$$hash),this.$$absUrl=this.getServerBase()+this.$$url.substr(1),this.updateBrowser=!0},p.prototype.absUrl=function(){return this.$$absUrl},p.prototype.url=function(t){if("string"!=typeof t)return this.$$url;t.length||(t="/");var e=i.exec(t);return e&&(!e[1]&&""!==t||this.path(this.urlCodec.decodePath(e[1])),(e[2]||e[1]||""===t)&&this.search(e[3]||""),this.hash(e[5]||"")),this},p.prototype.protocol=function(){return this.$$protocol},p.prototype.host=function(){return this.$$host},p.prototype.port=function(){return this.$$port},p.prototype.path=function(t){return void 0===t?this.$$path:(t="/"===(t=null!==t?t.toString():"").charAt(0)?t:"/"+t,this.$$path=t,this.composeUrls(),this)},p.prototype.search=function(t,e){switch(arguments.length){case 0:return this.$$search;case 1:if("string"==typeof t||"number"==typeof t)this.$$search=this.urlCodec.decodeSearch(t.toString());else{if("object"!=typeof t||null===t)throw new Error("LocationProvider.search(): First argument must be a string or an object.");for(var r in t=a({},t))null==t[r]&&delete t[r];this.$$search=t}break;default:if("string"==typeof t){var o=this.search();return null==e?delete o[t]:o[t]=e,this.search(o)}}return this.composeUrls(),this},p.prototype.hash=function(t){return void 0===t?this.$$hash:(this.$$hash=null!==t?t.toString():"",this.composeUrls(),this)},p.prototype.replace=function(){return this.$$replace=!0,this},p.prototype.state=function(t){return void 0===t?this.$$state:(this.$$state=t,this)},p);function p(t,e,r,o,a){var i=this;this.location=e,this.platformLocation=r,this.urlCodec=o,this.locationStrategy=a,this.initalizing=!0,this.updateBrowser=!1,this.$$absUrl="",this.$$url="",this.$$host="",this.$$replace=!1,this.$$path="",this.$$search="",this.$$hash="",this.$$changeListeners=[],this.cachedState=null,this.lastBrowserUrl="",this.lastCachedState=null;var n=this.browserUrl(),s=this.urlCodec.parse(n);if("string"==typeof s)throw"Invalid URL";this.$$protocol=s.protocol,this.$$host=s.hostname,this.$$port=parseInt(s.port)||c[s.protocol]||null,this.$$parseLinkUrl(n,n),this.cacheState(),this.$$state=this.browserState(),!function(t){return!!t&&"function"==typeof t.then}(t)?this.initialize(t):t.then(function(t){return i.initialize(t)})}var l=(u.prototype.$get=function(){return new s(this.ngUpgrade.$injector,this.location,this.platformLocation,this.urlCodec,this.locationStrategy)},u.prototype.hashPrefix=function(t){throw new Error("Configure LocationUpgrade through LocationUpgradeModule.config method.")},u.prototype.html5Mode=function(t){throw new Error("Configure LocationUpgrade through LocationUpgradeModule.config method.")},u);function u(t,e,r,o,a){this.ngUpgrade=t,this.location=e,this.platformLocation=r,this.urlCodec=o,this.locationStrategy=a}function f(){}var d=($.prototype.encodePath=function(t){for(var e=t.split("/"),r=e.length;r--;)e[r]=v(e[r].replace(/%2F/g,"/"));return function(t){return t.replace(/\/index.html$/,"")}(((t=e.join("/"))&&"/"!==t[0]?"/":"")+t)},$.prototype.encodeSearch=function(t){return"string"==typeof t&&(t=y(t)),(t=function(r){function t(e){var t=r[e];Array.isArray(t)?t.forEach(function(t){o.push(m(e,!0)+(!0===t?"":"="+m(t,!0)))}):o.push(m(e,!0)+(!0===t?"":"="+m(t,!0)))}var o=[];for(var e in r)t(e);return o.length?o.join("&"):""}(t))?"?"+t:""},$.prototype.encodeHash=function(t){return(t=v(t))?"#"+t:""},$.prototype.decodePath=function(t,e){void 0===e&&(e=!0);for(var r=t.split("/"),o=r.length;o--;)r[o]=decodeURIComponent(r[o]),e&&(r[o]=r[o].replace(/\//g,"%2F"));return r.join("/")},$.prototype.decodeSearch=function(t){return y(t)},$.prototype.decodeHash=function(t){return"#"===(t=decodeURIComponent(t))[0]?t.substring(1):t},$.prototype.normalize=function(t,e,r,o){if(1===arguments.length){var a=this.parse(t,o);if("string"==typeof a)return a;var i=a.protocol+"://"+a.hostname+(a.port?":"+a.port:"");return this.normalize(this.decodePath(a.pathname),this.decodeSearch(a.search),this.decodeHash(a.hash),i)}var n=this.encodePath(t),s=e&&this.encodeSearch(e)||"",h=r&&this.encodeHash(r)||"",c=(o||"")+n;return c.length&&"/"===c[0]||(c="/"+c),c+s+h},$.prototype.areEqual=function(t,e){return this.normalize(t)===this.normalize(e)},$.prototype.parse=function(e,r){try{var t=new URL(e,r);return{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}catch(t){throw new Error("Invalid URL ("+e+") with base ("+r+")")}},$);function $(){}function g(t){try{return decodeURIComponent(t)}catch(t){return}}function y(t){var a={};return(t||"").split("&").forEach(function(t){var e,r,o;t&&(r=t=t.replace(/\+/g,"%20"),-1!==(e=t.indexOf("="))&&(r=t.substring(0,e),o=t.substring(e+1)),void 0!==(r=g(r))&&(o=void 0===o||g(o),a.hasOwnProperty(r)?Array.isArray(a[r])?a[r].push(o):a[r]=[a[r],o]:a[r]=o))}),a}function v(t){return m(t,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function m(t,e){return void 0===e&&(e=!1),encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,e?"%20":"+")}var S,U=new e.InjectionToken("LOCATION_UPGRADE_CONFIGURATION"),w=new e.InjectionToken("APP_BASE_HREF_RESOLVED"),b=((S=C).config=function(t){return{ngModule:S,providers:[o.Location,{provide:s,useFactory:A,deps:[r.UpgradeModule,o.Location,o.PlatformLocation,f,o.LocationStrategy]},{provide:U,useValue:t||{}},{provide:f,useFactory:B,deps:[U]},{provide:w,useFactory:L,deps:[U,[new e.Inject(o.APP_BASE_HREF),new e.Optional]]},{provide:o.LocationStrategy,useFactory:_,deps:[o.PlatformLocation,w,U]}]}},C=S=function(t,e,r,o){var a,i=arguments.length,n=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,o);else for(var s=t.length-1;0<=s;s--)(a=t[s])&&(n=(i<3?a(n):3<i?a(e,r,n):a(e,r))||n);return 3<i&&n&&Object.defineProperty(e,r,n),n}([e.NgModule({imports:[o.CommonModule]})],C));function C(){}function L(t,e){return t&&null!=t.appBaseHref?t.appBaseHref:null!=e?e:""}function B(t){return new(t&&t.urlCodec||d)}function _(t,e,r){return void 0===r&&(r={}),r.useHash?new o.HashLocationStrategy(t,e):new o.PathLocationStrategy(t,e)}function A(t,e,r,o,a){return new l(t,e,r,o,a).$get()}t.ɵangular_packages_common_upgrade_upgrade_d=A,t.ɵangular_packages_common_upgrade_upgrade_a=L,t.ɵangular_packages_common_upgrade_upgrade_c=_,t.ɵangular_packages_common_upgrade_upgrade_b=B,t.$locationShim=s,t.$locationShimProvider=l,t.LOCATION_UPGRADE_CONFIGURATION=U,t.LocationUpgradeModule=b,t.AngularJSUrlCodec=d,t.UrlCodec=f,Object.defineProperty(t,"__esModule",{value:!0})});