{"version":3,"file":"datalist.js","sourceRoot":"","sources":["datalist.ts"],"names":[],"mappings":"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","sourcesContent":["import {NgModule,Component,ElementRef,AfterViewInit,AfterContentInit,OnDestroy,Input,Output,SimpleChange,EventEmitter,ContentChild,ContentChildren,TemplateRef,QueryList} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {SharedModule,Header,Footer,PrimeTemplate} from '../common/shared';\nimport {PaginatorModule} from '../paginator/paginator';\nimport {BlockableUI} from '../common/api';\n\n@Component({\n    selector: 'p-dataList',\n    template: `\n        <div [ngClass]=\"'ui-datalist ui-widget'\" [ngStyle]=\"style\" [class]=\"styleClass\">\n            <div class=\"ui-datalist-header ui-widget-header ui-corner-top\" *ngIf=\"header\">\n                <ng-content select=\"p-header\"></ng-content>\n            </div>\n            <p-paginator [rows]=\"rows\" [first]=\"first\" [totalRecords]=\"totalRecords\" [pageLinkSize]=\"pageLinks\" [alwaysShow]=\"alwaysShowPaginator\"\n            (onPageChange)=\"paginate($event)\" styleClass=\"ui-paginator-bottom\" [rowsPerPageOptions]=\"rowsPerPageOptions\" *ngIf=\"paginator  && paginatorPosition!='bottom' || paginatorPosition =='both'\"></p-paginator>\n            <div class=\"ui-datalist-content ui-widget-content\">\n                <div *ngIf=\"isEmpty()\" class=\"ui-datalist-emptymessage\">{{emptyMessage}}</div>\n                <ul class=\"ui-datalist-data\">\n                    <li *ngFor=\"let item of dataToRender;let i = index;trackBy: trackBy\">\n                        <ng-template [pTemplateWrapper]=\"itemTemplate\" [item]=\"item\" [index]=\"i\"></ng-template>\n                    </li>\n                </ul>\n            </div>\n            <p-paginator [rows]=\"rows\" [first]=\"first\" [totalRecords]=\"totalRecords\" [pageLinkSize]=\"pageLinks\" [alwaysShow]=\"alwaysShowPaginator\"\n            (onPageChange)=\"paginate($event)\" styleClass=\"ui-paginator-bottom\" [rowsPerPageOptions]=\"rowsPerPageOptions\" *ngIf=\"paginator  && paginatorPosition!='top' || paginatorPosition =='both'\"></p-paginator>\n            <div class=\"ui-datalist-footer ui-widget-header ui-corner-bottom\" *ngIf=\"footer\">\n                <ng-content select=\"p-footer\"></ng-content>\n            </div>\n        </div>\n    `\n})\nexport class DataList implements AfterViewInit,AfterContentInit,BlockableUI {\n\n    @Input() paginator: boolean;\n\n    @Input() rows: number;\n    \n    @Input() totalRecords: number;\n\n    @Input() pageLinks: number = 5;\n    \n    @Input() rowsPerPageOptions: number[];\n\n    @Input() lazy: boolean;\n    \n    @Output() onLazyLoad: EventEmitter<any> = new EventEmitter();\n\n    @Input() style: any;\n\n    @Input() styleClass: string;\n    \n    @Input() paginatorPosition: string = 'bottom';\n\n    @Input() emptyMessage: string = 'No records found';\n    \n    @Input() alwaysShowPaginator: boolean = true;\n    \n    @Input() trackBy: Function = (index: number, item: any) => item;\n    \n    @Output() onPage: EventEmitter<any> = new EventEmitter();\n        \n    @ContentChild(Header) header;\n\n    @ContentChild(Footer) footer;\n    \n    @ContentChildren(PrimeTemplate) templates: QueryList<any>;\n    \n    public _value: any[];\n    \n    public itemTemplate: TemplateRef<any>;\n\n    public dataToRender: any[];\n\n    public first: number = 0;\n    \n    public page: number = 0;\n\n    constructor(public el: ElementRef) {}\n    \n    ngAfterContentInit() {\n        this.templates.forEach((item) => {\n            switch(item.getType()) {\n                case 'item':\n                    this.itemTemplate = item.template;\n                break;\n                \n                default:\n                    this.itemTemplate = item.template;\n                break;\n            }\n        });\n    }\n\n    ngAfterViewInit() {\n        if(this.lazy) {\n            this.onLazyLoad.emit({\n                first: this.first,\n                rows: this.rows\n            });\n        }\n    }\n    \n    @Input() get value(): any[] {\n        return this._value;\n    }\n\n    set value(val:any[]) {\n        this._value = val;\n        this.handleDataChange();\n    }\n    \n    handleDataChange() {\n        if(this.paginator) {\n            this.updatePaginator();\n        }\n        this.updateDataToRender(this.value);\n    }\n    \n    updatePaginator() {\n        //total records\n        this.totalRecords = this.lazy ? this.totalRecords : (this.value ? this.value.length: 0);\n        \n        //first\n        if(this.totalRecords && this.first >= this.totalRecords) {\n            let numberOfPages = Math.ceil(this.totalRecords/this.rows);\n            this.first = Math.max((numberOfPages-1) * this.rows, 0);\n        }\n    }\n\n    paginate(event) {\n        this.first = event.first;\n        this.rows = event.rows;\n        \n        if(this.lazy) {\n            this.onLazyLoad.emit(this.createLazyLoadMetadata());\n        }\n        else {\n            this.updateDataToRender(this.value);\n        }\n        \n        this.onPage.emit({\n            first: this.first,\n            rows: this.rows\n        });\n    }\n\n    updateDataToRender(datasource) {\n        if(this.paginator && datasource) {\n            this.dataToRender = [];\n            let startIndex = this.lazy ? 0 : this.first;\n            for(let i = startIndex; i < (startIndex+ this.rows); i++) {\n                if(i >= datasource.length) {\n                    break;\n                }\n\n                this.dataToRender.push(datasource[i]);\n            }\n        }\n        else {\n            this.dataToRender = datasource;\n        }\n    }\n\n    isEmpty() {\n        return !this.dataToRender||(this.dataToRender.length == 0);\n    }\n    \n    createLazyLoadMetadata(): any {\n        return {\n            first: this.first,\n            rows: this.rows\n        };\n    }\n    \n    getBlockableElement(): HTMLElement {\n        return this.el.nativeElement.children[0];\n    }\n}\n\n@NgModule({\n    imports: [CommonModule,SharedModule,PaginatorModule],\n    exports: [DataList,SharedModule],\n    declarations: [DataList]\n})\nexport class DataListModule { }\n"]}