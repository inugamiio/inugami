{"version":3,"file":"gmap.js","sourceRoot":"","sources":["gmap.ts"],"names":[],"mappings":"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","sourcesContent":["import {NgModule,Component,ElementRef,OnInit,AfterViewInit,DoCheck,OnDestroy,Input,Output,EventEmitter,IterableDiffers,ChangeDetectorRef,NgZone} from '@angular/core';\nimport {CommonModule} from '@angular/common';\n\ndeclare var google: any;\n\n@Component({\n    selector: 'p-gmap',\n    template: `<div [ngStyle]=\"style\" [class]=\"styleClass\"></div>`\n})\nexport class GMap implements AfterViewInit,DoCheck {\n\n    @Input() style: any;\n        \n    @Input() styleClass: string;\n    \n    @Input() options: any;\n    \n    @Input() overlays: any[];\n    \n    @Output() onMapClick: EventEmitter<any> = new EventEmitter();\n    \n    @Output() onOverlayClick: EventEmitter<any> = new EventEmitter();\n    \n    @Output() onOverlayDragStart: EventEmitter<any> = new EventEmitter();\n    \n    @Output() onOverlayDrag: EventEmitter<any> = new EventEmitter();\n    \n    @Output() onOverlayDragEnd: EventEmitter<any> = new EventEmitter();\n    \n    @Output() onMapReady: EventEmitter<any> = new EventEmitter();\n    \n    differ: any;\n    \n    map: any;\n\n    constructor(public el: ElementRef,differs: IterableDiffers, public cd: ChangeDetectorRef, public zone:NgZone) {\n        this.differ = differs.find([]).create(null);\n    }\n\n    ngAfterViewInit() {\n        this.map = new google.maps.Map(this.el.nativeElement.children[0], this.options);\n        this.onMapReady.emit({\n            map: this.map\n        });\n        \n        if(this.overlays) {\n            for(let overlay of this.overlays) {\n                overlay.setMap(this.map);\n                this.bindOverlayEvents(overlay);\n            }\n        }\n        \n        this.map.addListener('click', (event) => {\n            this.zone.run(() => {\n                this.onMapClick.emit(event);\n            });\n        });\n    }\n    \n    bindOverlayEvents(overlay: any) {\n        overlay.addListener('click', (event) => {\n            this.zone.run(() => {\n                this.onOverlayClick.emit({\n                    originalEvent: event,\n                    'overlay': overlay,\n                    map: this.map\n                });\n            });\n        });\n        \n        if(overlay.getDraggable()) {\n            this.bindDragEvents(overlay);\n        }\n    }\n    \n    ngDoCheck() {\n        let changes = this.differ.diff(this.overlays);\n        \n        if(changes && this.map) {\n            changes.forEachRemovedItem((record) => {record.item.setMap(null)});\n            changes.forEachAddedItem((record) => {\n                record.item.setMap(this.map);\n                record.item.addListener('click', (event) => {\n                    this.zone.run(() => {\n                        this.onOverlayClick.emit({\n                            originalEvent: event,\n                            overlay: record.item,\n                            map: this.map\n                        });\n                    });\n                });\n                \n                if(record.item.getDraggable()) {\n                    this.bindDragEvents(record.item);\n                }\n            });\n        }\n    }\n    \n    bindDragEvents(overlay) {\n        overlay.addListener('dragstart', (event) => {\n            this.zone.run(() => {\n                this.onOverlayDragStart.emit({\n                    originalEvent: event,\n                    overlay: overlay,\n                    map: this.map\n                });\n            });\n        });\n        \n        overlay.addListener('drag', (event) => {\n            this.zone.run(() => {\n                this.onOverlayDrag.emit({\n                    originalEvent: event,\n                    overlay: overlay,\n                    map: this.map\n                });\n            });\n        });\n        \n        overlay.addListener('dragend', (event) => {\n            this.zone.run(() => {\n                this.onOverlayDragEnd.emit({\n                    originalEvent: event,\n                    overlay: overlay,\n                    map: this.map\n                });\n            });\n            \n        });\n    }\n    \n    getMap() {\n        return this.map;\n    }\n}\n\n@NgModule({\n    imports: [CommonModule],\n    exports: [GMap],\n    declarations: [GMap]\n})\nexport class GMapModule { }"]}